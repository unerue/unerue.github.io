
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Simulated Annealing &#8212; 경영과학과 컴퓨터 비전</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-171260246-1', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">경영과학과 컴퓨터 비전</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../index.html">
   데이터 과학
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Intermediate Python
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../object-oriented/01-object-oriented.html">
   객체 지향 프로그래밍
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../object-oriented/02-design-pattern.html">
   디자인 패턴
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Computer Vision
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../computer-vision/introduction.html">
   시작하기 앞서
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/image-libraries.html">
     영상 처리 라이브러리
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/numpy-matplotlib.html">
     NumPy와 Matplotlib
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../computer-vision/classifier-1.html">
   이미지 분류기(1)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/020-image-processing.html">
     2장 영상 처리
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/022-thresholding.html">
     임계처리
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/022-histogram.html">
     히스토그램
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/023-arithmetic-operation.html">
     산술 연산
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/024-geometric-transform.html">
     기하하적 변환
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/025-binarization.html">
     이진화와 모폴로지
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/021-color-space.html">
     색공간
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/030-filtering.html">
     영상 필터
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/070-machine-learning.html">
     7장 기계학습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/classifier-sift.html">
     SIFT (2004)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/032-blurring.html">
     Image Denoising with Denoising Autoencoder
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/classifier-hog.html">
     HOG
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/classifier-lenet.html">
     LeNet과 합성곱 신경망
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../computer-vision/classifier-2.html">
   이미지 분류기(2)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/classifier-alexnet.html">
     AlexNet
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/classifier-zfnet.html">
     ZFNet
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/classifier-nin.html">
     Network in Network
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/classifier-vgg.html">
     VGGNet
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/classifier-googlenet.html">
     GoogLeNet
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/classifier-resnet.html">
     ResNet
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/classifier-densenet.html">
     DenseNet
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../computer-vision/image-segmentation.html">
   영상 분할
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/semantic-fcn.html">
     FCN
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/semantic-unet.html">
     UNet
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/semantic-deeplab.html">
     DeepLab
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../computer-vision/object-detection.html">
   객체 탐지
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/object-rcnn.html">
     R-CNN
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/object-sppnet.html">
     SPPNet
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/object-fast-rcnn.html">
     Fast R-CNN
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/object-faster-rcnn.html">
     Faster R-CNN
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/object-ohem.html">
     OHEM
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/object-yolov1.html">
     YOLOv1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/object-ssd.html">
     SSD
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/object-fpn.html">
     FPN
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/object-retinanet.html">
     RetinaNet
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/object-yolov3.html">
     YOLOv3
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../computer-vision/instance-segmentation.html">
   개체 분할
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../computer-vision/instance-mask-rcnn.html">
     Mask R-CNN
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Operations Research
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../000-introduction.html">
   1장 시작하기 앞서
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../linear-programming/linear-programming.html">
   선형 계획법
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../linear-programming/product-mix.html">
     Product Mix Problem
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../linear-programming/production-planning.html">
     생산계획문제
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../linear-programming/sensitivity-analysis.html">
     민감도 분석
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../linear-programming/unbalanced-transportation.html">
     Unbalanced Transportation Problem
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../linear-programming/vehicle-routing.html">
     차량 경로 문제
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../linear-programming/workforce-scheduling.html">
     Workforce Scheduling
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../integer-programming/integer-programming.html">
   정수 계획법
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../integer-programming/traveling-salesman.html">
     Travelling Salesman Problem
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../integer-programming/knapsack.html">
     Knapsack Problem
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../integer-programming/capital-budgeting.html">
     Capital Budgeting Problem
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../integer-programming/plant.html">
     Plant Location Problem
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../integer-programming/set-covering.html">
     Set Covering Problem
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/operations-research/etc/introduction-simulated-annealing.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        
        <a class="issues-button"
            href="https://github.com/unerue/unerue.github.io/issues/new?title=Issue%20on%20page%20%2Foperations-research/etc/introduction-simulated-annealing.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/unerue/unerue.github.io/master?urlpath=lab/tree/operations-research/etc/introduction-simulated-annealing.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   어닐링
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   시뮬레이티드 어닐링의 구조
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     수락기준
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     냉각 스케줄
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     내부루프 반복수
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     종료 조건
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id7">
   시뮬레이티드 어닐링의 절차
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id8">
   파이썬으로 구현하는 시뮬레이티드 어닐링
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id9">
     해의 표현
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id10">
     적합도 함수
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id11">
     근접 변환
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id12">
   결론
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id13">
   참고문헌
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Simulated Annealing</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   어닐링
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   시뮬레이티드 어닐링의 구조
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     수락기준
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     냉각 스케줄
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     내부루프 반복수
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     종료 조건
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id7">
   시뮬레이티드 어닐링의 절차
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id8">
   파이썬으로 구현하는 시뮬레이티드 어닐링
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id9">
     해의 표현
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id10">
     적합도 함수
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id11">
     근접 변환
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id12">
   결론
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id13">
   참고문헌
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="section" id="simulated-annealing">
<h1>Simulated Annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h1>
<p style="text-indent: 1.5em"><b>시뮬레이티드 어닐링(simulated annealing, SA)</b>은 1983년 Kirkpatrick가 고체물리학의 어닐링(annealing)에서 영감을 얻어 개발한 메타휴리스틱스(metaheuristics)입니다. 시뮬레이티드 어닐링은 원리가 매우 단순하고 적용이 쉬워 최적화 문제 중 연속 또는 이산 문제 둘다 가능하며 매우 우수한 성능을 보여줍니다. 또한, 전역 최적해(global optimum)로의 수렴이 이론적으로 증명되어있습니다. 하지만 좋은 품질의 해를 도출하기 위해서는 계산소요시간이 매우 높다는 단점이 있습니다.</p>
<p style="text-indent: 1.5em">시뮬레이티드 어닐링이 개발되기 전 고체물리학에서 어닐링 과정은 이미 컴퓨터 시뮬레이션으로 모형화되어있었습니다. 1953년 Metropolis는 열탕에서 고체가 열평형(thermal equilibrium)에 도달하는 과정을 모사한 메트로폴리스 알고리즘을 제안했습니다.이러한 어닐링을 정리하면 다음과 같습니다.</p>
<div class="section" id="id1">
<h2>어닐링<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p style="text-indent: 1.5em">시뮬레이티드 어닐링에서 <b>어닐링(annealing)</b>을 정리하면 다음과 같습니다. 첫째, 고체를 열탕에서 액체 상태가 될 때까지 가열한 후 온도를 서서히 낮추어 가장 안정된 결정상태의 고체를 얻는 과정이며 둘째, 고체가 녹아 액체 상태가 되면 입자들이 자유롭게 움직이다가, 온도를 서서히 낮추면 기저상태(ground state)에 도달합니다. 셋째, 기저상태에서 입자들이 매우 구조화된 격자 형태로 배열되고 시스템의 에너지는 최소화됩니다. 넷째, 고체의 기저상태는 온도를 충분히 올린 후 냉각(cooling)이 아주 서서히 이루어질 때 가능하며 마지막으로 온도를 급격히 내리면 고체가 기저상태가 아니라 준안정상태(metastable state)로 언 상태로 변화합니다. 이러한 물리적 시스템과 최적화 문제의 유사점은 다음 <b>표 1</b>과 같습니다.</p>
<div style="text-align: center; padding-top: 1em; padding-bottom: 1em;"><b>표 1 </b>물리적 시스템과 최적화 문제의 유사점<br>
    <table align="center">
        <tr>
            <th>물리적 시스템(physical System)</th>
            <th>최적화 문제(optimization Problem)</th>
        </tr>
        <tr>
            <td>시스템 상태(system state)</td>
            <td>해(solution)</td>
        </tr>
        <tr>
            <td>에너지(energy)</td>
            <td>목적함수(objective function)</td>
        </tr>
        <tr>
            <td>기저 상태(ground state)</td>
            <td>전역 최적해(global solution)</td>
        </tr>
        <tr>
            <td>준안정 상태(meta-stable state)</td>
            <td>지역 최적해(local solution)</td>
        </tr>
        <tr>
            <td>온도(temperature)</td>
            <td>제어 파라미터(control parameter) $T$</td>
        </tr>
        <tr>
            <td>급냉각(rapid quenching)</td>
            <td>지역 탐색법(local search)</td>
        </tr>
    </table>
</div>
</div>
<div class="section" id="id2">
<h2>시뮬레이티드 어닐링의 구조<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p style="text-indent: 1.5em">시뮬레이티드 어닐링은 초기화 단계에서 초기온도($T$), 초기해($x_{0}$), 초기 반복수($L$) 등을 설정하며 $L$은 메트로폴리스 알고리즘에서의 고정된 온도 $T$에서 평형상태에 도달할 때까지 필요한 근접 변화(perturbation)의 반복수를 나타내는 파라미터입니다. 근접 변화는 이웃해의 탐색을 뜻하며 상태의 전이(transition)과 같은 개념입니다. 시뮬레이티드 어닐링은 외부루프와 내부루프로 구성되어 있으며 초기값이 결정되면 온도 $T$에서 현재해($x$)의 이웃해($x^{\prime}$)를 생성하여 이웃해의 목적함수 값 $f(x^{\prime})$이 현재해의 목적함수 값 $f(x)$보다 작으면 이웃해를 현재해로 받아들이고, 그렇지 않으면 확률로 개선되지 않은 해를 현재해로 받아들입니다. 이러한 내부루프를 $L$회 반복합니다. 그 후 외부루프에서 온도 $T$를 낮추고 종료 조건이 만족할 때까지 반복합니다. 이때 좋지 않은 해를 확률적으로 받아들이면서 지역 최적해를 탈출해 전역 최적해로 나아갈 가능성을 얻게 됩니다.</p>
<p style="text-indent: 1.5em">시뮬레이티드 어닐링의 핵심은 수락확률(acceptance probability)과 냉각 스케줄(cooling schedule)의 선택입니다. 수락확률은 개선되지 않은 이웃해로의 이동을 가능하게 하고, 냉각 스케줄은 알고리즘을 반복할때마다 온도 $T$를 적절하게 낮추는 방법을 말합니다. 그리고 메타휴리스틱스의 공통 요소를 순서대로 적용하는 것이 매우 중요합니다.</p>
<div class="section" id="id3">
<h3>수락기준<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p style="text-indent: 1.5em">시뮬레이티드 어닐링은 현재해보다 더 좋은 이웃해가 있으면 이동하지만, 현재해보다 더 나쁜 이웃해를 확률적으로 받아들입니다. 나쁜 이웃해를 받아들이는 기준은 메트로폴리스를 사용합니다. 현재해 $x$와 이웃해 $x^{\prime}$로 그리고 목적함수 값은 $f(x)$와 $f(x^{\prime})$로 정의합니다. 현재해 $x$에서 이웃해 $x^{\prime}$으로 이동을 $f(x^{\prime}) \le f(x)$이거나 $\exp{(-\frac{f(x^{\prime}) - f(x)}{T})} \ge \text{random}(0,1)$이면 수락합니다. 따라서 내리막길에서 언덕을 다시 올라가듯이 수락확률로 현재해보다 나쁜 이웃해를 받아들이고 지역해에서 탈출하기 위한 현재해 $x$에서 이웃해 $x^{\prime}$로 이동은 다음과 같습니다.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{cases}
f(x^{\prime}) \le f(x),\\
\exp{(-\frac{f(x^{\prime}) - f(x)}{T})} \ge \text{random}(0,1)
\end{cases}\end{split}\]</div>
<p style="text-indent: 1.5em">목적함수 값 $\Delta = f(x^{\prime})-f(x)$가 $0$보다 크거나 같으면 $\exp(-\Delta/T)$를 확인하는데, 온도 $T$가 $\infty$면 이웃해 $x^{\prime}$를 받아들인 확률이 $1$이고 $T$가 $0$이면 수락 확률이 $0$이 되는 매커니즘입니다. 최적화 문제에서 목적함수 값을 최소화는 것은 $\Delta = f(x^{\prime})-f(x)$이며 최대화는 $\Delta = f(x)-f(x^{\prime})$입니다.</p>
</div>
<div class="section" id="id4">
<h3>냉각 스케줄<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p style="text-indent: 1.5em">냉각 스케줄(cooling schedule)은 해의 성능에 큰 영향을 미치는데 적절한 냉각 스케줄을 선택하지 않으면 좋은 해를 구하기 어렵습니다. 대표적인 냉각 스케줄은 선형(linear) 스케줄, 기하(geometric) 스케줄, 로그(logarithmic) 스케줄 등이 있습니다. 먼저 냉각 스케줄의 방법을 선택하기 전에 초기 온도를 설정해야 합니다. 초기에는 온도 $T$가 매우 높기 때문에 수락확률이 높게 설정되어 대부분 이웃해를 받아들입니다. 초기 온도를 구하는 방법으로는 초기해의 목적함수 값으로 설정하는 방법, 실험을 통해 목적함수 값의 표준편차($\sigma$)를 이용하는 방법 등이 있습니다. 냉각 스케줄은 초기 온도$T_{0}$에서 $k$번째 강하된 $T_{k}$로 나타냅니다.</p>
<ul class="simple">
<li><p>선형 스케줄은 시뮬레이티드 어닐링에서 가장 간단한 방법으로 식(1)과 같으며, <span class="math notranslate nohighlight">\(\beta\)</span>는 양의 상수입니다.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{equation}
T_{k}=T_{0}-k\beta
\end{equation}\]</div>
<ul class="simple">
<li><p>기하 스케줄은 시뮬레이티드 어닐링에서 온도가 식(2)처럼 낮아집니다. 기하 스케줄은 온도를 내릴 때 온도의 강하율(<span class="math notranslate nohighlight">\(\alpha\)</span>)를 사용하는데 일반적으로 <span class="math notranslate nohighlight">\(0.5\)</span>에서 <span class="math notranslate nohighlight">\(0.99\)</span> 값이 사용됩니다.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{equation}
T_{k}=\alpha T_{k-1} \quad k=1,2,\dots, \; 0 \lt \alpha \lt 1
\end{equation}\]</div>
<ul class="simple">
<li><p>로그 스케줄은 식(3)과 같으며 <span class="math notranslate nohighlight">\(c\)</span>는 양의 상수입니다.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{equation}
T_{k}=\frac{c}{\log{(k+1)}}
\end{equation}\]</div>
</div>
<div class="section" id="id5">
<h3>내부루프 반복수<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p style="text-indent: 1.5em">시뮬레이티드 어닐링은 외부루프와 내부루프가 존재하는데, 내부루프의 반복수는 주어진 온도에서 평형 상태에 이를 때까지의 반복 횟수를 뜻합니다. 온도 강하 전략과 밀접하게 관련있으며 온도의 하락 폭이 크면 각각의 온도에서 평형 상태의 목적함수 값의 차이가 커지기 때문에 각 온도에서 평형상태를 이루는 반복수가 많아집니다. 반면 온도의 하락 폭이 작으면 적은 반복에도 쉽게 평형 상태를 이룰 수 있습니다. 시뮬레이티드 어닐링은 계산소요시간이 길어지면 해의 품질이 향상되는데, 해의 향상을 얻을 때 내부루프의 반복수를 증가시크느 ㄴ 것보다 온도의 하락 폭을 줄이는 것이 좋습니다. 매 온도에서 평성상태에 도달하는데 요구되는 반복수는 문제의 크기에 따라 지수적으로 증가합니다. 따라서 적절한 내부루프의 반복수를 결정해야합니다. 첫째, 일반적인 방법으로 해의 크기에 일정한 상수를 곱하여 내부루프의 반복수가 일정하게 유지되는 정적(static) 방법이 있습니다. 둘째, 내부루프의 반복수가 상황에 따라 변하는 정응적 방법(adaptive method)로 해의 평균값이 빨리 떨어지는 온도에서는 더 멈물게 하는 개념을 사용하는 것입니다.</p>
</div>
<div class="section" id="id6">
<h3>종료 조건<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p style="text-indent: 1.5em">시뮬레이티드 어닐링의 종료 조건(terminal condition)은 온도가 0에 도달할 때 멈추는 것입니다. 첫째, 종료 조건의 온도 $T$를 $0.01$로 설정하거나 둘째, 지금까지 발견한 가장 좋은 해가 개선되지 않으면 종료하는 것 그리고 수락확률이 일정 수준 이하로 떨어진 후에 해의 향상 여부에 따라 종료시점을 결정하는 것입니다. 온도가 떨어지면 수락확률이 $0$에 수렴되기 때문에 종료 조건의 온도까지 매우 오랜 시간이 걸립니다. 따라서 한계치 아래로 내려가면 카운터를 시작하여 일정한 카운터까지 더 좋은 해가 발견되지 않으면 종료하는 방식입니다.</p>
</div>
</div>
<div class="section" id="id7">
<h2>시뮬레이티드 어닐링의 절차<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h2>
<p style="text-indent: 1.5em">시뮬레이티드 어닐링의 절차는 다음과 같습니다.</p>
<ul style="list-style-type: none;">
  <li><b>STEP 1: </b></li>
    <ol>
      <li>초기 온도 $T$와 내부루프 반복 수 $L$을 설정한다.</li>
      <li>초기 가능해 $x_0$을 구하고 현재해 $x=x_{0}$로 설정한다.</li>
      <li>냉각 스케줄링과 종료조건을 설정한다.</li>
    </ol>
  <li><b>STEP 2:</b></li>
    <ol>
      <li>현재해를 근접 변화시켜 이웃해를 생성한다.</li>
      <li>현재해와 이웃해의 목적함수 값 차이 $\Delta=f(x^{\prime})-f(x)$를 계산한다.</li>
      <li>$\Delta \le 0$이면 이웃해를 현재해로 두고 <b>STEP 3</b>, 그렇지 않으면 <b>STEP 2.4</b></li>
      <li>$\exp(-\delta/T) \ge \text{random}(0,1)$이면 이웃해를 현재해로 설정한다.</li>
    </ol>
  <li><b>STEP 3:</b></li>
    <ol>
      <li>외부루프 종료조건을 만족하면 종료하고, </li>
      <li>그렇지 않으면 냉각 스케줄링에 따라 𝑇를 조정한다.</li>
    </ol>
</ul>
</div>
<div class="section" id="id8">
<h2>파이썬으로 구현하는 시뮬레이티드 어닐링<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">metaheuristics.problems</span> <span class="kn">import</span> <span class="n">TravelingSalesman</span>

<span class="n">cities</span> <span class="o">=</span> <span class="n">TravelingSalesman</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
<span class="n">cities</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="nn">Input In [1],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">from</span> <span class="nn">metaheuristics.problems</span> <span class="kn">import</span> <span class="n">TravelingSalesman</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">cities</span> <span class="o">=</span> <span class="n">TravelingSalesman</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">cities</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;metaheuristics&#39;
</pre></div>
</div>
</div>
</div>
<div class="section" id="id9">
<h3>해의 표현<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<p style="text-indent: 1.5em">초기해의 표현 방법은 순열(permutation)을 사용했습니다.</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">solution</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cities</span><span class="p">))))</span>
<span class="n">solution</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">route</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 6, 3, 9, 7, 1, 5, 4, 8, 2]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id10">
<h3>적합도 함수<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<p style="text-indent: 1.5em">메타휴리스틱스로 분류된 기법들은 모두 목적함수(objective function)를 적합도함수(fitness function)이라고 표현하겠습니다. 적합도 함수는 다음과 같습니다.</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fitness</span><span class="p">(</span><span class="n">solution</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">cities</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">solution</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="p">[</span><span class="n">solution</span><span class="p">[</span><span class="mi">0</span><span class="p">]])])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fitness</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>675
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id11">
<h3>근접 변환<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<p style="text-indent: 1.5em">이웃해를 탐색하기 위한 방법으로 <a href="https://en.wikipedia.org/wiki/2-opt">2-opt</a>를 사용하였습니다. 이를 근접 변환(perturbation)이라고 합니다. 최적화에서 2-opt는 1958년 Croes가 외판원 문제의 최적해를 구하기 위해 처음 제안한 아주 간단한 지역 탐색 알고리즘입니다. 주요 아이디어는 <b>그림 1</b>과 같이 두 지점을 선택하여 두 지점 사이의 경로를 역순으로 정렬한 다음 교차하는 것입니다.</p>
<div style="text-align: center; padding-top: 1em; padding-bottom: 1em;"><img src="images/figures/sa-01.png" width="30%" /><br><b>그림 1 </b>2-opt 방법</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">two_opt</span><span class="p">(</span><span class="n">solution</span><span class="p">):</span>
    <span class="n">new_solution</span> <span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">changed</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">while</span> <span class="n">changed</span><span class="p">:</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">solution</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">j</span><span class="o">-</span><span class="n">i</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">new_solution</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">j</span><span class="p">])</span>
            <span class="n">changed</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">continue</span>
    <span class="k">return</span> <span class="n">new_solution</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">two_opt</span><span class="p">(</span><span class="n">solution</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 8, 5, 6, 4, 2, 7, 3, 1, 9]
[0, 8, 5, 6, 4, 2, 1, 3, 7, 9]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SimulatedAnnealing</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Simulated Annealing</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cities</span><span class="p">,</span> <span class="n">stop_temp</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">max_iter</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cities</span> <span class="o">=</span> <span class="n">cities</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_temp</span> <span class="o">=</span> <span class="n">stop_temp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_iter</span> <span class="o">=</span> <span class="n">max_iter</span>  <span class="c1"># internal loops</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">history</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">_fitness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solution</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">cities</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">solution</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="p">[</span><span class="n">solution</span><span class="p">[</span><span class="mi">0</span><span class="p">]])])</span>
        
    <span class="k">def</span> <span class="nf">_two_opt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solution</span><span class="p">):</span>
        <span class="n">new_solution</span> <span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">changed</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">while</span> <span class="n">changed</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">solution</span><span class="p">)))</span>
            <span class="k">if</span> <span class="n">j</span><span class="o">-</span><span class="n">i</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">new_solution</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">j</span><span class="p">])</span>
                <span class="n">changed</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">continue</span>
                
        <span class="k">return</span> <span class="n">new_solution</span>

    <span class="k">def</span> <span class="nf">_acceptance_probability</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">delta</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Initial solution</span>
        <span class="n">initial_solution</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cities</span><span class="p">))))</span>
        <span class="n">initial_solution</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initial_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fitness</span><span class="p">(</span><span class="n">initial_solution</span><span class="p">)</span>

        <span class="n">current_solution</span> <span class="o">=</span> <span class="n">initial_solution</span>
        <span class="n">current_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_value</span>
               
        <span class="c1"># Initial temperature</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_value</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_temp</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_iter</span><span class="p">):</span>
                <span class="n">candidate_solution</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_two_opt</span><span class="p">(</span><span class="n">current_solution</span><span class="p">)</span>
                <span class="n">candidate_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fitness</span><span class="p">(</span><span class="n">candidate_solution</span><span class="p">)</span>
                
                <span class="n">delta</span> <span class="o">=</span> <span class="n">candidate_value</span> <span class="o">-</span> <span class="n">current_value</span>
                <span class="k">if</span> <span class="n">delta</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">current_solution</span> <span class="o">=</span> <span class="n">candidate_solution</span>
                    <span class="n">current_value</span> <span class="o">=</span> <span class="n">candidate_value</span>
                                      
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_acceptance_probability</span><span class="p">(</span><span class="n">delta</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">():</span>
                    <span class="n">current_solution</span> <span class="o">=</span> <span class="n">candidate_solution</span>
                    <span class="n">current_value</span> <span class="o">=</span> <span class="n">candidate_value</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">current_value</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simulated_annealing</span> <span class="o">=</span> <span class="n">SimulatedAnnealing</span><span class="p">(</span><span class="n">cities</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">simulated_annealing</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>296
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">simulated_annealing</span><span class="o">.</span><span class="n">history</span><span class="p">)),</span> <span class="n">simulated_annealing</span><span class="o">.</span><span class="n">history</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">simulated_annealing</span><span class="o">.</span><span class="n">initial_value</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Initial distance&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">simulated_annealing</span><span class="o">.</span><span class="n">history</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Best distance&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_annealing</span><span class="o">.</span><span class="n">history</span><span class="p">)])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Iteration&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Distance&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
          <span class="n">fancybox</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;sa.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/introduction-simulated-annealing_12_0.png" src="../../_images/introduction-simulated-annealing_12_0.png" />
</div>
</div>
<div style="text-align: center; padding-top: 1em; padding-bottom: 1em;"><img src="images/figures/sa-02.png" width="50%" /><br><b>그림 2 </b>시뮬레이티드 어닐링의 최적해</div>
<p style="text-indent: 1.5em">시뮬레이티드 어닐링이 동작하면서 최적해를 찾아 수렴하는 과정을 시각화하면 <b>그림 2</b>와 같습니다. 초기온도가 높기 때문에 초기해보다 나쁜 해를 받아들이면서 지역 최적해를 벗어나는 것을 볼 수가 있습니다. 하지만, 앞서 말했듯이 시뮬레이티드 어닐링은 오랜 시간이 걸릴 수록 좋은 해를 찾습니다. 따라서 현재 입력된 파라미터는 최적해보다 근사해를 받아들일 경우가 더 많을 것 입니다. 이웃해를 찾는 과정, 냉각 스케줄, 그리고 내부루프 반복수를 조절하는 것이 좋을 수가 있습니다.</p>
</div>
</div>
<div class="section" id="id12">
<h2>결론<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h2>
<p style="text-indent: 1.5em">시뮬레이티드 어닐링 개념과 절차 그리고 파이썬을 이용하여 구현해보았습니다. 시뮬레이티드 어닐링의 절차를 구현하는 건 매우 쉬우나, 해의 표현, 적합도 함수 정의 그리고 이웃해를 탐색할 규칙을 정하는 것이 매우 고민되는 문제입니다.</p>
</div>
<div class="section" id="id13">
<h2>참고문헌<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Cover: <a class="reference external" href="http://examples.gurobi.com/traveling-salesman-problem/">http://examples.gurobi.com/traveling-salesman-problem/</a></p></li>
<li><p>Kirkpatrick, S., Gelatt, C. D., &amp; Vecchi, M. P. (1983). Optimization by Simulated Annealing. <em>Science</em>, 220(4598), 671-680.</p></li>
<li><p>Eglese, R. W. (1990). Simulated Annealing: A Tool for Operational Research. <em>European Journal of Operational Research</em>, 46(3), 271-281.</p></li>
<li><p>Hillier, F. S. &amp; Lieberman, G. J. (2013). <em>Introduction to Operations Research</em>. McGraw-Hill Science, Engineering &amp; Mathematics.</p></li>
<li><p>Luke, S. (2013). <em>Essentials of Metaheuristics</em>.</p></li>
<li><p>김여근 (2017). <em>메타휴리스틱스</em>. 전남대학교출판부.</p></li>
</ol>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./operations-research\etc"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Kyung-Su Kang<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>